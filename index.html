<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="style.css" />
        <script src="nes.js"></script>
        <script src="megaman2.js"></script>
        <script src="arp.js"></script>
        <script src="mixing-test.js"></script>
        <script src="kk.js"></script>
    </head>
    <body>
        <div id="input-container">
            <textarea data-channel="PWM1" class="note-input"></textarea>
            <textarea data-channel="PWM2" class="note-input"></textarea>
            <textarea data-channel="TRIANGLE" class="note-input"></textarea>
            <textarea data-channel="NOISE" class="note-input"></textarea>
        </div>
        <footer>
            <span id="controls-container">
                <button id="stop">Stop</button>
            </span>
            <button id="megaman">Megaman</button>
            <button id="kk">Kart Kingdom</button>
        </footer>

<script>
var playerFor = function(songName) {
    return function() {
        NES.Sequencer.stop();
        NES.Oscillators.context.resume().then(() => {
            NES.Sequencer.play(window[songName].melody, true);
        });
    };
};

var A = function(id, song) {
    var playSong = playerFor(song);
    document.getElementById(id).addEventListener('click', playSong);
};

A('megaman', 'Megaman2');
A('kk', 'KK');
document.getElementById('stop').addEventListener('click', () => NES.Sequencer.stop());
        </script>
    </body>
</html>
